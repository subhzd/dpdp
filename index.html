<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messi Legacy</title>
    
    <!-- Apple & Favicon Icons -->
    <link rel="apple-touch-icon" href="messi.png">
    <link rel="icon" type="image/png" href="https://messi.aimaverick.me/messi.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://messi.aimaverick.me">
    <meta property="og:title" content="Messi Legacy">
    <meta property="og:description" content="48 Trophies. Legacy = ∞. A visual journey through history.">
    <meta property="og:image" content="https://messi.aimaverick.me/messi_od.png">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Messi: The Career Timeline">
    <meta name="twitter:description" content="48 Trophies. Legacy = ∞. A visual journey through history.">
    <meta name="twitter:image" content="https://messi.aimaverick.me/messi_od.png">

    <script src="cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="gsap.min.js"></script>
    <script src="ScrollTrigger.min.js"></script>
    <script src="ScrollToPlugin.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Anton&family=Roboto:wght@300;400;700&display=swap');

        :root {
            --barca-red: #EDBB00;
            --barca-blue: #004D98;
            --arg-blue: #75AADB;
            --psg-navy: #004171;
            --miami-pink: #F7B5CD;
            --miami-black: #231F20;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #0f172a;
            background-image: 
                radial-gradient(at 0% 0%, rgba(15, 23, 42, 1) 0, transparent 50%), 
                radial-gradient(at 100% 0%, rgba(30, 41, 59, 1) 0, transparent 50%);
            color: white;
            overflow-x: hidden;
        }

        .font-header {
            font-family: 'Anton', sans-serif;
        }

        /* Snake Path SVG */
        .snake-svg-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        .snake-path {
            fill: none;
            stroke: rgba(255, 255, 255, 0.05);
            stroke-width: 4;
        }
        
        .snake-path-progress {
            fill: none;
            stroke: url(#gradient);
            stroke-width: 4;
            stroke-linecap: round;
        }

        /* The Ball - Argentina Style */
        .soccer-ball {
            position: absolute;
            left: 0;
            top: 0;
            width: 36px;
            height: 36px;
            transform: translate(-50%, -50%);
            z-index: 50; /* Higher than cards */
            /* Argentina jersey stripes */
            background: repeating-linear-gradient(90deg, #75AADB 0px, #75AADB 9px, #FFFFFF 9px, #FFFFFF 18px);
            border-radius: 50%;
            /* Blue glow */
            box-shadow: 0 0 25px 5px rgba(117, 170, 219, 0.8);
            border: 2px solid rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #1e293b;
        }

        /* Liquid Glass Card base */
        .liquid-card {
            position: absolute; /* Controlled by JS Grid */
            width: 280px;  /* Back to wider landscape width */
            height: 140px; /* Reduced height for sleekness */
            /* Removed generic background */
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            opacity: 0;
            transform: scale(0.8);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow: hidden;
            z-index: 10; /* Ensure card sits above the path marker */
        }

        /* Mobile adjustment for cards if screen is very narrow */
        @media (max-width: 350px) {
            .liquid-card {
                width: 90vw;
            }
        }

        .liquid-card.active {
            opacity: 1;
            transform: scale(1);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        /* Mystery Animation for the Final Card */
        @keyframes mystery-pulse {
            0% { opacity: 0.4; transform: scale(0.95); filter: blur(2px); box-shadow: 0 0 0 rgba(255, 215, 0, 0); }
            50% { opacity: 1; transform: scale(1.05); filter: blur(0px); box-shadow: 0 0 40px rgba(255, 215, 0, 0.6); }
            100% { opacity: 0.4; transform: scale(0.95); filter: blur(2px); box-shadow: 0 0 0 rgba(255, 215, 0, 0); }
        }

        .liquid-card.active.future-card {
            animation: mystery-pulse 4s infinite ease-in-out;
            z-index: 50;
            border-color: rgba(255, 215, 0, 0.5);
        }

        /* Team-colored Glass Backgrounds & Accents */
        .card-bg-barca {
            background: rgba(0, 77, 152, 0.25); /* var(--barca-blue) opacity */
            border-color: rgba(237, 187, 0, 0.4);
            border-bottom: 3px solid var(--barca-red);
        }
        .card-bg-argentina {
            background: rgba(117, 170, 219, 0.25); /* var(--arg-blue) opacity */
            border-color: rgba(255, 255, 255, 0.5);
            border-bottom: 3px solid var(--arg-blue);
            color: #f8fafc;
        }
        /* Make icon subtler on light bg */
        .card-bg-argentina i.absolute { color: rgba(255,255,255,0.2) !important; }

        .card-bg-psg {
            background: rgba(0, 65, 113, 0.25); /* var(--psg-navy) opacity */
            border-color: rgba(218, 41, 28, 0.4);
            border-bottom: 3px solid var(--psg-navy);
        }
        .card-bg-miami {
            background: rgba(35, 31, 32, 0.4); /* var(--miami-black) opacity */
            border-color: rgba(247, 181, 205, 0.5);
            border-bottom: 3px solid var(--miami-pink);
        }
        .card-bg-future {
            background: rgba(255, 215, 0, 0.15); /* Gold tint */
            border: 2px solid rgba(255, 215, 0, 0.8);
            border-bottom: 3px solid #fff;
        }


        .team-tag {
            font-size: 0.65rem;
            padding: 2px 6px;
            border-radius: 4px;
            text-transform: uppercase;
            font-weight: bold;
            letter-spacing: 0.05em;
            width: fit-content;
        }
        .bg-tag-barca { background: linear-gradient(90deg, #004D98, #A50044); }
        .bg-tag-argentina { background: linear-gradient(90deg, #75AADB, #fff); color: #1e293b; }
        .bg-tag-psg { background: linear-gradient(90deg, #004171, #DA291C); }
        .bg-tag-miami { background: linear-gradient(90deg, #231F20, #F7B5CD); }
        .bg-tag-future { background: linear-gradient(90deg, #FFD700, #FFA500); color: #1e293b; }


        /* Controls */
        .control-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 100;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #fbbf24;
            color: #1e293b;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: transform 0.2s;
        }
        .control-btn:hover {
            transform: scale(1.1);
        }

        /* Marker on the path */
        .path-marker {
            width: 12px;
            height: 12px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            position: absolute;
            transform: translate(-50%, -50%);
            transition: all 0.3s;
            z-index: 1; /* Behind the cards */
        }
        .path-marker.active {
            background: #fbbf24;
            box-shadow: 0 0 15px #fbbf24;
            transform: translate(-50%, -50%) scale(1.5);
        }

        /* Sleek Scoreboard */
        #scoreboard {
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 100;
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 9999px; /* Pill shape */
            padding: 0.75rem 1.75rem;
            display: flex;
            gap: 2rem;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            transition: all 0.3s;
            align-items: center;
        }

        /* Responsive adjustments for controls */
        @media (max-width: 640px) {
            #scoreboard {
                bottom: 20px;
                left: 20px;
                padding: 0.5rem 1rem;
                gap: 1rem;
                transform-origin: bottom left;
                transform: scale(0.85);
            }
            
            .control-btn {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
            
            .font-header.text-6xl {
                font-size: 2.5rem; /* Smaller hero text */
            }
            
            .liquid-card.w-96 {
                width: 90vw !important; /* Make start/end cards fit screen */
            }
        }

        .score-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .score-label {
            font-size: 0.6rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: #94a3b8;
            margin-bottom: 0.1rem;
        }

        .score-value {
            font-family: 'Anton', sans-serif;
            font-size: 1.75rem; /* Smaller, sleeker */
            line-height: 1;
            color: #fbbf24;
            text-shadow: 0 0 15px rgba(251, 191, 36, 0.4);
            min-width: 60px;
            text-align: center;
        }
        
        /* Hide scoreboard on very start */
        body.is-top #scoreboard {
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
        }

    </style>
</head>
<body class="bg-slate-900 is-top">

    <!-- Auto Play Button -->
    <div id="auto-play-btn" class="control-btn" title="Toggle Auto-Play">
        <i class="fas fa-play" id="play-icon"></i>
    </div>

    <!-- Live Scoreboard -->
    <div id="scoreboard">
        <div class="score-item">
            <span class="score-label">Goals</span>
            <span class="score-value" id="stats-goals">0</span>
        </div>
        <div class="w-px bg-white/10 h-8 self-center"></div>
        <div class="score-item">
            <span class="score-label">Assists</span>
            <span class="score-value" id="stats-assists">0</span>
        </div>
    </div>

    <!-- Hero -->
    <div class="relative min-h-[50vh] flex flex-col items-center justify-center pt-20 pb-10 z-10">
        <div class="flex items-center justify-center gap-3 md:gap-5 mb-4 px-4">
            <div class="w-12 h-12 md:w-24 md:h-24 rounded-full overflow-hidden border-4 border-yellow-500 shadow-[0_0_20px_rgba(234,179,8,0.5)] bg-slate-800 flex-shrink-0">
                <img src="messi.png" alt="Messi" class="w-full h-full object-cover" onerror="this.src='https://upload.wikimedia.org/wikipedia/commons/c/c1/Lionel_Messi_2006.jpg'">
            </div>
            <h1 class="font-header text-4xl md:text-8xl text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500 glowing-text">LEGACY</h1>
        </div>
        <p class="text-slate-400 text-sm md:text-lg mb-8 tracking-widest font-light text-center">48 Trophies. Legacy = ∞</p>

        <!-- Start Card -->
        <div class="liquid-card card-bg-barca !relative !transform-none !opacity-100 !w-96 !h-auto mb-10 p-6 mx-auto">
            <div class="flex flex-col items-center text-center mb-2">
                <div class="w-32 h-32 md:w-40 md:h-40 rounded-full overflow-hidden border-4 border-yellow-500 bg-slate-800 shadow-xl mb-4 relative group">
                    <img src="messi17.png" alt="Messi 17" class="w-full h-full object-contain transform group-hover:scale-110 transition-transform duration-500" onerror="this.src='https://upload.wikimedia.org/wikipedia/commons/c/c1/Lionel_Messi_2006.jpg'">
                </div>
                <div>
                    <h2 class="font-header text-3xl md:text-4xl mb-1">ROOKIE LEO</h2>
                    <div class="team-tag bg-tag-barca mx-auto">Barcelona</div>
                </div>
            </div>
            <p class="text-slate-300 text-sm text-center">The journey begins at age 17.</p>
        </div>
        
        <div class="animate-bounce mt-4 text-yellow-500">
            <i class="fas fa-chevron-down text-2xl"></i>
        </div>
    </div>

    <!-- Timeline Container -->
    <div class="relative w-full max-w-[1400px] mx-auto pb-10" id="timeline-container">
        
        <!-- SVG Layer for Snake Path -->
        <div class="snake-svg-container">
            <svg width="100%" height="100%" id="main-svg">
                <defs>
                    <linearGradient id="gradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#fbbf24;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#f59e0b;stop-opacity:1" />
                    </linearGradient>
                </defs>
                <path id="path-bg" class="snake-path" d="" />
                <path id="path-progress" class="snake-path-progress" d="" />
            </svg>
        </div>
        
        <!-- The Ball -->
        <div class="soccer-ball" id="ball">
            <i class="fas fa-futbol animate-spin-slow"></i>
        </div>

        <!-- Trophy Data Injection Point -->
        <div id="trophy-grid" class="relative z-10 w-full h-full">
            <!-- JS will populate this with absolute positioned cards -->
        </div>
    </div>

    <!-- Footer -->
    <div class="relative min-h-[20vh] flex flex-col items-center justify-center pt-0 pb-20 z-10 bg-gradient-to-t from-black to-transparent">
        <div class="liquid-card card-bg-miami !relative !transform-none !opacity-100 !w-96 !h-auto p-8 border-2 border-pink-400/30 mx-auto">
             <div class="flex flex-col items-center text-center">
                 <div class="w-40 h-40 md:w-48 md:h-48 rounded-full overflow-hidden border-4 border-pink-500 bg-slate-800 shadow-2xl mb-6 relative group">
                    <img src="messi38.png" alt="Messi 38" class="w-full h-full object-contain transform group-hover:scale-110 transition-transform duration-500" onerror="this.src='https://upload.wikimedia.org/wikipedia/commons/b/b4/Lionel-Messi-Argentina-2022-FIFA-World-Cup_%28cropped%29.jpg'">
                 </div>
                 <h2 class="font-header text-5xl md:text-6xl mb-2 text-transparent bg-clip-text bg-gradient-to-r from-pink-400 to-yellow-400">G.O.A.T.</h2>
                 <p class="text-slate-300 text-md md:text-lg">Most decorated player in history.</p>
             </div>
        </div>
    </div>

    <!-- Thin Legal Footer -->
    <div class="w-full py-1 px-4 bg-black/90 border-t border-white/5 flex justify-between items-center text-[10px] text-slate-500 relative z-50 font-mono tracking-wide">
        <a href="https://aimaverick.me" target="_blank" class="hover:text-yellow-500 transition-colors">© 2025 @amsubhzd</a>
        <span class="absolute left-1/2 transform -translate-x-1/2 opacity-70 whitespace-nowrap">Designed by AI Maverick</span>
        <span>v1.0</span>
    </div>

    <script>
        // Data Set - Updated with Exact Age Data + Approximate Goals/Assists at that point in time
        const trophyData = [
            { id: 1, year: "2004–05", trophy: "La Liga", team: "Barcelona", age: "17:10", goals: 1, assists: 0 },
            { id: 2, year: "2005", trophy: "FIFA U‑20 World Cup", team: "Argentina U‑20", age: "18:00", goals: 10, assists: 5 }, // Includes U20
            { id: 3, year: "2005", trophy: "Supercopa de España", team: "Barcelona", age: "18:01", goals: 12, assists: 6 },
            { id: 4, year: "2005–06", trophy: "La Liga", team: "Barcelona", age: "18:10", goals: 17, assists: 9 },
            { id: 5, year: "2005–06", trophy: "UEFA Champions League", team: "Barcelona", age: "18:11", goals: 20, assists: 11 },
            { id: 6, year: "2006", trophy: "Supercopa de España", team: "Barcelona", age: "19:02", goals: 25, assists: 12 },
            { id: 7, year: "2008", trophy: "Olympic Gold Medal", team: "Argentina Olympic", age: "21:01", goals: 45, assists: 20 },
            { id: 8, year: "2008–09", trophy: "Copa del Rey", team: "Barcelona", age: "21:10", goals: 65, assists: 30 },
            { id: 9, year: "2008–09", trophy: "La Liga", team: "Barcelona", age: "21:10", goals: 75, assists: 35 },
            { id: 10, year: "2008–09", trophy: "UEFA Champions League", team: "Barcelona", age: "21:11", goals: 80, assists: 40 },
            { id: 11, year: "2009", trophy: "Supercopa de España", team: "Barcelona", age: "22:01", goals: 90, assists: 42 },
            { id: 12, year: "2009", trophy: "UEFA Super Cup", team: "Barcelona", age: "22:02", goals: 92, assists: 43 },
            { id: 13, year: "2009", trophy: "FIFA Club World Cup", team: "Barcelona", age: "22:05", goals: 100, assists: 45 },
            { id: 14, year: "2009–10", trophy: "La Liga", team: "Barcelona", age: "22:10", goals: 127, assists: 52 },
            { id: 15, year: "2010", trophy: "Supercopa de España", team: "Barcelona", age: "23:01", goals: 130, assists: 55 },
            { id: 16, year: "2010–11", trophy: "La Liga", team: "Barcelona", age: "23:10", goals: 175, assists: 75 },
            { id: 17, year: "2010–11", trophy: "UEFA Champions League", team: "Barcelona", age: "23:11", goals: 180, assists: 80 },
            { id: 18, year: "2011", trophy: "Supercopa de España", team: "Barcelona", age: "24:01", goals: 185, assists: 82 },
            { id: 19, year: "2011", trophy: "UEFA Super Cup", team: "Barcelona", age: "24:02", goals: 186, assists: 83 },
            { id: 20, year: "2011", trophy: "FIFA Club World Cup", team: "Barcelona", age: "24:05", goals: 200, assists: 90 },
            { id: 21, year: "2011–12", trophy: "Copa del Rey", team: "Barcelona", age: "24:11", goals: 253, assists: 105 }, // The 73 goal season
            { id: 22, year: "2012–13", trophy: "La Liga", team: "Barcelona", age: "25:10", goals: 313, assists: 122 }, // The 91 goal year
            { id: 23, year: "2013", trophy: "Supercopa de España", team: "Barcelona", age: "26:02", goals: 320, assists: 125 },
            { id: 24, year: "2014–15", trophy: "La Liga", team: "Barcelona", age: "27:10", goals: 400, assists: 160 },
            { id: 25, year: "2014–15", trophy: "Copa del Rey", team: "Barcelona", age: "27:11", goals: 405, assists: 165 },
            { id: 26, year: "2014–15", trophy: "UEFA Champions League", team: "Barcelona", age: "27:11", goals: 412, assists: 170 },
            { id: 27, year: "2015", trophy: "UEFA Super Cup", team: "Barcelona", age: "28:01", goals: 415, assists: 172 },
            { id: 28, year: "2015", trophy: "FIFA Club World Cup", team: "Barcelona", age: "28:05", goals: 425, assists: 175 },
            { id: 29, year: "2015–16", trophy: "La Liga", team: "Barcelona", age: "28:10", goals: 450, assists: 190 },
            { id: 30, year: "2015–16", trophy: "Copa del Rey", team: "Barcelona", age: "28:11", goals: 453, assists: 192 },
            { id: 31, year: "2016", trophy: "Supercopa de España", team: "Barcelona", age: "29:01", goals: 460, assists: 195 },
            { id: 32, year: "2016–17", trophy: "Copa del Rey", team: "Barcelona", age: "29:11", goals: 507, assists: 210 },
            { id: 33, year: "2017–18", trophy: "La Liga", team: "Barcelona", age: "30:10", goals: 552, assists: 230 },
            { id: 34, year: "2017–18", trophy: "Copa del Rey", team: "Barcelona", age: "30:10", goals: 552, assists: 230 },
            { id: 35, year: "2018", trophy: "Supercopa de España", team: "Barcelona", age: "31:01", goals: 560, assists: 235 },
            { id: 36, year: "2018–19", trophy: "La Liga", team: "Barcelona", age: "31:10", goals: 603, assists: 250 },
            { id: 37, year: "2020–21", trophy: "Copa del Rey", team: "Barcelona", age: "33:09", goals: 672, assists: 280 }, // End of Barca
            { id: 38, year: "2021", trophy: "Copa América", team: "Argentina (senior)", age: "34:00", goals: 680, assists: 285 },
            { id: 39, year: "2021–22", trophy: "Ligue 1", team: "Paris Saint‑Germain", age: "34:10", goals: 700, assists: 300 },
            { id: 40, year: "2022", trophy: "Finalissima", team: "Argentina (senior)", age: "34:11", goals: 705, assists: 302 },
            { id: 41, year: "2022", trophy: "Trophée des Champions", team: "Paris Saint‑Germain", age: "35:01", goals: 706, assists: 303 },
            { id: 42, year: "2022", trophy: "FIFA World Cup", team: "Argentina (senior)", age: "35:05", goals: 793, assists: 350 }, // Career peak stats approx
            { id: 43, year: "2022–23", trophy: "Ligue 1", team: "Paris Saint‑Germain", age: "35:11", goals: 805, assists: 355 },
            { id: 44, year: "2023", trophy: "Leagues Cup", team: "Inter Miami", age: "36:01", goals: 815, assists: 358 },
            { id: 45, year: "2024", trophy: "Copa América", team: "Argentina (senior)", age: "37:00", goals: 830, assists: 365 },
            { id: 46, year: "2024", trophy: "MLS Supporters’ Shield", team: "Inter Miami", age: "37:03", goals: 840, assists: 370 },
            { id: 47, year: "2025", trophy: "MLS Eastern Conference", team: "Inter Miami", age: "38:05", goals: 850, assists: 375 },
            { id: 48, year: "2025", trophy: "MLS Cup", team: "Inter Miami", age: "38:05", goals: 855, assists: 380 },
            { id: 49, year: "2026", trophy: "World Cup 2026", team: "Argentina (senior)", age: "39:00", goals: 896, assists: 407, isFuture: true }
        ];

        const gridContainer = document.getElementById('trophy-grid');
        const timelineContainer = document.getElementById('timeline-container');
        const statsGoals = document.getElementById('stats-goals');
        const statsAssists = document.getElementById('stats-assists');

        // Styles Helper
        function getStyles(item) {
            if (item.isFuture) return { bg: "card-bg-future", tag: "bg-tag-future" };
            const teamName = item.team;
            if (teamName.includes("Barcelona")) return { bg: "card-bg-barca", tag: "bg-tag-barca" };
            if (teamName.includes("Argentina")) return { bg: "card-bg-argentina", tag: "bg-tag-argentina" };
            if (teamName.includes("Paris") || teamName.includes("PSG")) return { bg: "card-bg-psg", tag: "bg-tag-psg" };
            if (teamName.includes("Miami")) return { bg: "card-bg-miami", tag: "bg-tag-miami" };
            return { bg: "", tag: "bg-slate-700" };
        }

        function getIcon(item) {
            if (item.isFuture) return "fa-star"; 
            const t = item.trophy.toLowerCase();
            if (t.includes("ucl") || t.includes("champions league")) return "fa-globe-europe";
            if (t.includes("club world cup")) return "fa-globe";
            if (t.includes("world cup")) return "fa-globe";
            if (t.includes("liga") || t.includes("ligue")) return "fa-shield-alt";
            if (t.includes("copa") || t.includes("cup") && !t.includes("super")) return "fa-wine-glass";
            if (t.includes("supercopa") || t.includes("super cup") || t.includes("trophée") || t.includes("finalissima")) return "fa-trophy";
            if (t.includes("olympic")) return "fa-medal";
            if (t.includes("shield")) return "fa-shield";
            return "fa-trophy";
        }

        function formatAge(ageStr) {
            if (!ageStr.includes(':')) return ageStr;
            const [y, m] = ageStr.split(':');
            return `${y}`; 
        }

        // --- GRID LAYOUT LOGIC ---
        const CARD_WIDTH = 280; 
        const CARD_HEIGHT = 140; 
        const GAP_X = 40;
        const GAP_Y = 60;

        let pathPoints = [];

        function renderGrid() {
            const containerWidth = Math.min(window.innerWidth - 40, 1400);
            const availableWidth = containerWidth;
            
            let cols = Math.floor(availableWidth / (CARD_WIDTH + GAP_X));
            if (cols < 1) cols = 1;
            if (cols > 4) cols = 4; 

            const totalGridWidth = (cols * CARD_WIDTH) + ((cols - 1) * GAP_X);
            const startX = (availableWidth - totalGridWidth) / 2;

            gridContainer.innerHTML = "";
            pathPoints = [];
            
            let totalHeight = 0;

            trophyData.forEach((item, index) => {
                let x, y;
                let isLast = index === trophyData.length - 1;

                if (isLast && item.isFuture) {
                    // CENTER THE LAST CARD
                    const row = Math.floor(index / cols); 
                    
                    const prevRow = Math.floor((index - 1) / cols);
                    let targetRow = Math.floor(index / cols);
                    
                    y = targetRow * (CARD_HEIGHT + GAP_Y);
                    x = (availableWidth - CARD_WIDTH) / 2; 
                    
                } else {
                    const row = Math.floor(index / cols);
                    const isReverseRow = row % 2 !== 0;
                    const colIndexRaw = index % cols;
                    const colIndex = isReverseRow ? (cols - 1 - colIndexRaw) : colIndexRaw;

                    x = startX + (colIndex * (CARD_WIDTH + GAP_X));
                    y = row * (CARD_HEIGHT + GAP_Y);
                }

                // Create Card Element
                const { bg, tag } = getStyles(item);
                const icon = getIcon(item);
                const displayAge = formatAge(item.age);
                const futureClass = item.isFuture ? 'future-card' : '';

                const el = document.createElement('div');
                el.className = `liquid-card ${bg} ${futureClass}`;
                el.style.left = `${x}px`;
                el.style.top = `${y}px`;
                el.innerHTML = `
                    <div class="flex justify-between items-start">
                        <span class="text-xs font-bold opacity-70">${item.year}</span>
                        <div class="team-tag ${tag}">${item.team.split(' ')[0]}</div>
                    </div>
                    <div class="relative z-10 mt-2 flex-grow flex flex-col justify-center">
                        <h3 class="font-header text-2xl leading-none mb-1 text-balance drop-shadow-md">${item.trophy}</h3>
                        <div class="text-sm font-bold opacity-80 mt-1">Age ${displayAge}</div>
                    </div>
                    <i class="fas ${icon} absolute bottom-2 right-2 text-6xl opacity-10 -rotate-12"></i>
                `;
                gridContainer.appendChild(el);

                const marker = document.createElement('div');
                marker.className = 'path-marker';
                marker.style.left = `${x + CARD_WIDTH/2}px`;
                marker.style.top = `${y + CARD_HEIGHT/2}px`;
                gridContainer.appendChild(marker);

                pathPoints.push({
                    x: x + CARD_WIDTH/2,
                    y: y + CARD_HEIGHT/2,
                    element: el,
                    marker: marker,
                    data: item
                });

                totalHeight = y + CARD_HEIGHT + GAP_Y;
            });

            gridContainer.style.height = `${totalHeight + 100}px`; 
            
            drawSnakePath();
        }

        function drawSnakePath() {
            if (pathPoints.length === 0) return;

            const svg = document.getElementById('main-svg');
            const pathBg = document.getElementById('path-bg');
            const pathProgress = document.getElementById('path-progress');

            let d = `M ${pathPoints[0].x} -50 L ${pathPoints[0].x} ${pathPoints[0].y} `;

            for (let i = 0; i < pathPoints.length - 1; i++) {
                const p1 = pathPoints[i];
                const p2 = pathPoints[i+1];
                
                if (Math.abs(p1.y - p2.y) < 10) {
                    d += `L ${p2.x} ${p2.y} `;
                } else {
                    const midY = (p1.y + p2.y) / 2;
                    d += `C ${p1.x} ${midY}, ${p2.x} ${midY}, ${p2.x} ${p2.y} `;
                }
            }

            const last = pathPoints[pathPoints.length-1];
            d += `L ${last.x} ${last.y + 100}`;

            pathBg.setAttribute('d', d);
            pathProgress.setAttribute('d', d);

            const totalLength = pathBg.getTotalLength();
            pathProgress.style.strokeDasharray = totalLength;
            pathProgress.style.strokeDashoffset = totalLength;

            initScrollTrigger(totalLength);
        }

        // --- GSAP ANIMATION ---
        
        let timelineTrigger;
        let autoScrollTween; // Global ref
        let lastIndex = -1; // Stats update tracker

        function updateStats(goals, assists) {
            gsap.to(statsGoals, {
                innerText: goals,
                duration: 0.5,
                snap: { innerText: 1 },
                ease: "power1.out",
                overwrite: true // Fix for overlapping animations
            });
            gsap.to(statsAssists, {
                innerText: assists,
                duration: 0.5,
                snap: { innerText: 1 },
                ease: "power1.out",
                overwrite: true // Fix for overlapping animations
            });
        }

        function initScrollTrigger(pathLen) {
            if (timelineTrigger) timelineTrigger.kill();
            ScrollTrigger.getAll().forEach(t => t.kill());

            const ball = document.getElementById('ball');
            const pathBg = document.getElementById('path-bg');
            const pathProgress = document.getElementById('path-progress');

            // 0. Toggle Scoreboard Visibility
            ScrollTrigger.create({
                trigger: "#timeline-container",
                start: "top 80%",
                onEnter: () => document.body.classList.remove('is-top'),
                onLeaveBack: () => document.body.classList.add('is-top')
            });

            // 1. Ball & Path Animation & Stats Update
            timelineTrigger = ScrollTrigger.create({
                trigger: "#timeline-container",
                start: "top center",
                end: "bottom center",
                scrub: 0.5,
                onUpdate: (self) => {
                    const progress = self.progress;
                    const drawLength = pathLen * progress;
                    
                    gsap.set(pathProgress, { strokeDashoffset: pathLen - drawLength });

                    const point = pathBg.getPointAtLength(drawLength);
                    gsap.set(ball, {
                        left: point.x,
                        top: point.y,
                        rotation: progress * 360 * 10
                    });

                    // Stats Update - Based on progress, not individual triggers
                    const totalItems = trophyData.length;
                    const rawIndex = Math.floor(progress * totalItems);
                    const currentIndex = Math.max(0, Math.min(rawIndex, totalItems - 1));

                    if (currentIndex !== lastIndex) {
                        const data = trophyData[currentIndex];
                        updateStats(data.goals, data.assists);
                        lastIndex = currentIndex;
                    }
                }
            });

            // 2. Card Entrance Triggers
            pathPoints.forEach((pt, i) => {
                ScrollTrigger.create({
                    trigger: pt.element,
                    start: "top 85%", 
                    end: "bottom 15%",
                    onEnter: () => {
                        pt.element.classList.add('active');
                        pt.marker.classList.add('active');
                    },
                    onEnterBack: () => {
                        // Keep active if scrolling back
                    }
                });
            });
        }

        // --- AUTO PLAY LOGIC ---
        let isAutoPlaying = false;
        const autoPlayBtn = document.getElementById('auto-play-btn');
        const playIcon = document.getElementById('play-icon');

        function toggleAutoPlay(forcePlay = false) {
            if (forcePlay) {
                isAutoPlaying = false; 
                window.scrollTo(0, 0); // Force top for initial
            }
            
            isAutoPlaying = !isAutoPlaying;
            
            if (isAutoPlaying) {
                playIcon.classList.remove('fa-play');
                playIcon.classList.add('fa-pause');
                
                // Check if at bottom, if so restart
                const maxScroll = document.body.scrollHeight - window.innerHeight;
                if (window.scrollY >= maxScroll - 10) {
                    window.scrollTo(0, 0);
                }
                
                const totalHeight = document.body.scrollHeight;
                const currentScroll = window.scrollY;
                const distance = totalHeight - currentScroll;
                const speed = 150;
                const duration = distance / speed;

                autoScrollTween = gsap.to(window, {
                    duration: duration, 
                    scrollTo: { y: "max", autoKill: true }, 
                    ease: "none",
                    onComplete: () => {
                        isAutoPlaying = false;
                        playIcon.classList.remove('fa-pause');
                        playIcon.classList.add('fa-play');
                    },
                    onInterrupt: () => {
                        isAutoPlaying = false;
                        playIcon.classList.remove('fa-pause');
                        playIcon.classList.add('fa-play');
                    }
                });
            } else {
                playIcon.classList.remove('fa-pause');
                playIcon.classList.add('fa-play');
                if (autoScrollTween) autoScrollTween.kill();
            }
        }

        autoPlayBtn.addEventListener('click', () => toggleAutoPlay());

        // Init
        window.addEventListener('load', () => {
            // Force start at top to ensure consistent experience
            window.scrollTo(0, 0);
            
            renderGrid();
            
            // Check LocalStorage for Autoplay
            const hasPlayed = localStorage.getItem('messi_timeline_played');
            if (!hasPlayed) {
                // Initial Play after a short delay
                setTimeout(() => {
                    toggleAutoPlay(true);
                    localStorage.setItem('messi_timeline_played', 'true');
                }, 1000);
            }
        });
        
        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(renderGrid, 200);
        });

    </script>

    <script>window.va=window.va||function(){(window.va.q=window.va.q||[]).push(arguments)};</script><script src="/_vercel/insights/script.js"></script>
	<script>window.si=window.si||function(){(window.siq=window.siq||[]).push(arguments)};</script><script src="/_vercel/speed-insights/script.js"></script>	
        
</body>
</html>